# Battlespace
Geoffrey Argence geargenc@student.42.fr
Résumé: Dans l'espace, c'est mieux.

## I - Préambule

Voici ce que Wikipédia a à dire de l'Histoire de l'enregistrement sonore :

L'**histoire de l'enregistrement sonore** a commencé en 1877 par deux inventions simultanées : le [phonographe](https://fr.wikipedia.org/wiki/Phonographe "Phonographe") par [Thomas Edison](https://fr.wikipedia.org/wiki/Thomas_Edison "Thomas Edison"), qui rend utilisable une idée de [Édouard-Léon Scott de Martinville](https://fr.wikipedia.org/wiki/%C3%89douard-L%C3%A9on_Scott_de_Martinville "Édouard-Léon Scott de Martinville"), le phonautographe, et le [gramophone](https://fr.wikipedia.org/wiki/Gramophone "Gramophone") par [Émile Berliner](https://fr.wikipedia.org/wiki/%C3%89mile_Berliner "Émile Berliner"). Le matériel d'enregistrement et de restitution a évolué jusqu'à un traitement entièrement numérique.
### Les systèmes mécaniques

Le premier phonographe a été inventé pour le divertissement de la population par l'écoute de musiques diverses.

Ce phonographe fonctionnait sur un principe d'utilisation simple : son dispositif permettait d'enregistrer des sons grâce à un stylet composé d'une aiguille interchangeable. Ce stylet grave les sonorités sur un cylindre d'étain (qui sera remplacé plus tard par un cylindre de cire, ce qui améliora la qualité de l'enregistrement). Lorsque l'enregistrement est terminé, la gravure peut être lue par le stylet. L'aiguille fait vibrer le diaphragme et transforme le sillon gravé en sons. Afin de permettre la diffusion de ces premiers enregistrements, un mécanisme de recopie sur cylindre de bakélite est mis au point : la qualité est meilleure et le cylindre ne craint plus les déformations ni la chaleur.

Le  [gramophone](https://fr.wikipedia.org/wiki/Gramophone "Gramophone"), qui dispose d'une tête réversible et d'un cornet en guise de micro, enregistre sur un disque au lieu d'un cylindre.

Les cylindres sont difficiles à reproduire, au contraire des disques, et la qualité acoustique est similaire. Les disques triomphent rapidement.

### L'enregistrement électrique

L'invention de la  [triode](https://fr.wikipedia.org/wiki/Triode_(%C3%A9lectronique) "Triode (électronique)")  en 1906 débouche rapidement sur l'utilisation de  [microphones](https://fr.wikipedia.org/wiki/Microphones "Microphones")  et de graveurs électriques pour la réalisation de disques.

Un nouveau support apparait en 1948 : le disque vinyle à microsillons.

Un  [disque vinyle](https://fr.wikipedia.org/wiki/Disque_vinyle "Disque vinyle"), appelé aussi microsillon ou disque noir, est un support d'enregistrement sonore. Chaque face est parcourue par un sillon microscopique en spirale dont le début est en règle générale à l'extérieur et la fin vers le centre du disque (même si certains disques sont gravés dans le sens contraire).

### Procédé phonographique

En 1928, on utilise l'enregistrement par phonographie pour le cinéma parlant.

### Supports magnétiques

Le  [magnétophone](https://fr.wikipedia.org/wiki/Magn%C3%A9tophone "Magnétophone")  permet d'enregistrer des sons sur une bande magnétique. Les bandes peuvent être en bobine ou en cassette audio.

En 1964, la cassette audio commence à être commercialisée. À cette époque, c'est l'entreprise Philips qui les fabrique. Elle comporte deux bobines où est enroulée une bande magnétique. Elle permet d'enregistrer ou d'écouter de la musique ou bien tout autre type de sons. Son principe de fonctionnement est le suivant. Quatre canaux (pistes) sont écrits en parallèle sur la bande, 2x2 canaux stéréo. Deux sont enregistrés lorsque la bande se trouve sur un côté dans le lecteur ou l'enregistreur et deux autres lorsqu'elle est retournée. Certains lecteurs de cassettes peuvent lire successivement les deux côtés de la cassette sans que l'utilisateur ait besoin de la retourner manuellement. Généralement, cela est possible grâce à une tête de lecture double et par l'inversion du sens de défilement de la bande, mais certains lecteurs retournent réellement la cassette.

### Enregistrements numériques

En 1981, ce fut une révolution dans l'histoire du son : le  [disque compact](https://fr.wikipedia.org/wiki/Disque_compact "Disque compact")  fit son apparition.

**Ce sujet n'a pas grand chose à voir avec l'enregistrement sonore, vous commencez à avoir l'habitude :)**

## II - Introduction

An 2096: Le scientifique Richard Tellman met au point la théorie du Tout en reprenant les travaux de Stephen Hawking.

An 2124: Elaboration du premier prototype de moteur à distorsions X-AE-A12, permettant à un véhicule dans le vide d'avoisiner la vitesse de la lumière.

An 2138: Les conditions climatiques de la Terre sont catastrophiques et maintenant propices qu'au développement de quelques espèces micro-organiques. Les espèces encore vivantes sont réunies dans des endroits clos que l'on appelle paradis afin de préserver leur patrimoine génétique. Les humains doivent porter une combinaison spéciale pour sortir à l'air libre.

An 2140: Antoine Daniel sort l'épisode 38 de What the Cut.

An 2157: Des colonies sont envoyées sur une douzaine d'exoplanètes connues et une émigration massive est organisée sur Mars. Le gouvernement s'organise sur Mars et rallie toute l'humanité sous le drapeau de la "Nation".

An 2162: Le dernière goutte de pétrole, objet de collection, est vendue aux enchères sur ebay.sol pour la somme de 16'342$.

An 2196: Dans un dernier espoir, les Terriens désignent leur lune comme destination pour les déchets radioactifs et autres polluants.

An 2237: Le bouclier magnétique de la Terre a complètement disparu. La Terre étant trop proche du Soleil pour garantir l'efficacité des technologies utilisées par les colonies, les populations restantes n'y survivent pas.

An 2304: L'écrivaine Ece Erdogan décrit la vie marsienne par une métaphore de l'univers carcéral : "les étoiles en guise de barreaux".

An 2318: Mars reçoit un message d'une exo-colonie ayant fait la rencontre d'une autre forme de vie intelligente, leurs intentions sont pacifiques.

Nous sommes en 2623 et vous vivez au sein d'une colonie sur Nébunor. Votre meilleur ami découvre un pacte secret passé entre les aliens et les hauts dirigeants de l'humanité. Ce pacte assure à ces derniers et à leurs proches une vie confortable en échange de la servitude de l'humanité présente sur Mars. Vous organisez avec lui une résistance afin de répandre cette information aux autre colonies. Cependant, votre groupe est vite repéré et votre tête est mise à prix. Vous découvrez que vous êtes traqué par la Nation, les aliens ainsi qu'un groupe de mercenaires souhaitant empocher la récompense. Vous êtes actuellement dans une grande nébuleuse à proximité du système d'Arcantar et vous détectez une flotte en approche. Cependant, à cause de la nébuleuse et grâce à une potion d'aide au scénario vous êtes dans l'impossibilité de déterminer clairement votre ennemi et sa position. Connaissant la composition et les technologies des flottes de votre ennemi, vous décidez de mettre au point une stratégie afin d'optimiser votre attaque.

## III - Objectifs

L'objectif de votre algorithme sera d'identifier au plus vite la flotte que vous affrontez et d'adapter votre code pour être le plus efficace possible.

## IV - Consignes générales

* Ce projet sera évalué par une moulinette.
* Vous devez coder en C, à la norme. La norminette fait foi, j'insiste.
* Votre exécutable devra s'appeler *btsp*.
* Vous rendrez un dossier ayant pour nom votre login. Il contiendra un Makefile contenant les règles habituelles. Vous êtes libre d'organiser vos fichiers comme vous le souhaitez et d'utiliser votre libft.
* Lors du rendu, pour un souci de propreté, vous nommerez votre commit "btsp x" où x est votre login.
* Vous avez le droit d'utiliser les fonctions suivantes :
	* read
	* write
	* malloc
	* free
	* gettimeofday
	* srand (3)
	* rand (3)

## V - Sujet

Vous devez coder un joueur de bataille navale. Celui-ci sera exécuté par une vm.
La grille comportera 10 lignes de A à J et 10 colonnes de 0 à 9.

Un coup se composera, d'une lettre désignant la ligne, d'un chiffre désignant la colonne et sera suivi d'un '\n'.
Le résultat pourra être "MISS", "HIT", "SUNK" ou "BLOCKED" et sera également suivi d'un '\n'.

Vous écrirez vos coups sur la sortie standard et vous lirez leur réponse sur l'entrée standard.

Vous affronterez une des 3 armées ci-dessous (les vaisseaux sont indiqués de 0 à 4) :
* La Nation :

|   | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 |
|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|
| A | . | . | . | . | . | . | . | . | . | . |
| B | . | 0 | . | 1 | . | 2 | . | 3 | . | 4 |
| C | . | 0 | . | 1 | . | 2 | . | 3 | . | 4 |
| D | . | 0 | . | 1 | . | 2 | . | 3 | . | . |
| E | . | 0 | . | 1 | . | . | . | . | . | . |
| F | . | 0 | . | . | . | . | . | . | . | . |
| G | . | . | . | . | . | . | . | . | . | . |
| H | . | . | . | . | . | . | . | . | . | . |
| I | . | . | . | . | . | . | . | . | . | . |
| J | . | . | . | . | . | . | . | . | . | . |

* Les mercenaires :

| . | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 |
|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|
| A | . | . | . | . | . | . | . | . | . | . |
| B | . | . | 0 | . | . | 1 | 1 | . | . | . |
| C | . | 0 | 0 | 0 | . | 1 | 1 | . | . | . |
| D | . | . | 0 | . | . | . | . | . | . | . |
| E | . | . | . | . | . | . | . | . | . | . |
| F | . | 2 | . | 3 | . | 4 | 4 | . | . | . |
| G | . | 2 | . | 3 | . | . | . | . | . | . |
| H | . | 2 | . | 3 | . | . | . | . | . | . |
| I | . | . | . | . | . | . | . | . | . | . |
| J | . | . | . | . | . | . | . | . | . | . |

* Les aliens :

| . | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 |
|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|
| A | . | . | . | . | . | . | . | . | . | . |
| B | . | . | 0 | . | . | . | 1 | . | . | . |
| C | . | . | 0 | . | . | 1 | . | 1 | . | . |
| D | . | . | 0 | . | . | . | 1 | . | . | . |
| E | . | 0 | . | 0 | . | . | . | . | . | . |
| F | . | . | . | . | . | . | . | . | . | . |
| G | . | . | . | 2 | . | . | . | 3 | . | . |
| H | . | . | 2 | . | . | . | 3 | . | . | 4 |
| I | . | 2 | . | . | . | 3 | . | . | . | 4 |
| J | . | . | . | . | . | . | . | . | . | . |

Votre but sera d'anéantir l'armée adverse en le moins de coups possibles.
L'armée adverse est considérée comme détruite lorsque tous les vaisseaux qui la composent sont détruits. Un vaisseau quant à lui, est considéré comme détruit lorsque toutes ses parties (chaque case qui le compose) sont détruites.

* Lors de la destruction d'un vaisseau, la vm vous renvoie "SUNK".
* Hors du cas précédent, lors de la destruction d'une partie d'un vaisseau, la vm vous renvoie "HIT".
* Lorsque vous tirez sur une case vide ou détruite, la vm vous renvoie "MISS".

Vous ne saurez pas quelle armée vous affrontez et votre programme devra la reconnaitre au cours de la partie si vous voulez espérer faire un bon score.

Afin de rendre la suite plus claire nous allons définir le terme de "contact". Deux cases a et b sont en contact, si et seulement s'il existe un côté ou un coin de a commun avec b. Deux éléments a et b sont en contact si et seulement s'il existe une case de l'élément a et une case de l'élément b qui sont en contact.

Les vaisseaux de l'armée que vous affrontez seront placés et orientés de manière aléatoire sur la grille. Les vaisseaux placés ne pourront pas être en contact. Les quatre orientations possibles d'un vaisseau ne peuvent s'obtenir que par des rotations de 90°.

Quelle que soit l'armée, la grille comportera les particularités suivantes :
* Une annexe d'artillerie sera ajoutée sur un des vaisseaux, en contact avec lui. Cette annexe ne risque pas d'être en contact avec un second vaisseau. Chaque vaisseau a la même probabilité de recevoir l'annexe. Cette annexe fait partie intégrante du vaisseau et doit également être détruite pour que le vaisseau soit considéré comme détruit.
* Une mine, qui ne peut en aucun cas être en contact avec un vaisseau. Il n'est pas nécessaire de la détruire pour terminer la partie, mais lors de sa destruction, la vm vous renverra "HIT".
* Un générateur de bouclier, qui peut, lui, être placé au contact d'un autre élément et qui protège toutes les cases du carré de 25 cases dont il est le centre (carré de 5 cases de côté). Lors de la destruction d'un générateur de bouclier, la vm renvoie "SUNK". Lorsque vous visez une case protégée par un bouclier, la vm renvoie "BLOCKED" - ou "MISS" si la case est vide ou a déjà été détruite.

Le générateur de grilles map_gen.py et la vm battlespace (`gcc battlespace.c -o battlespace`) sont disponibles dans le dossier. Si vous avez besoin d'afficher des choses avec votre programme pendant vos tests, vous pouvez le faire sur la sortie d'erreur. Aussi si vous voulez que votre programme puisse lire sur le terminal pendant vos tests vous pouvez également lire depuis la sortie d'erreur (si si). La vm s'appelle de la manière suivante : `./battlespace map btsp`
Je vous laisse faire `./map_gen.py -h` pour voir les options du générateur de cartes. Notez tout de même que votre rendu ne sera testé qu'avec des grilles contenant une annexe, une mine et un générateur de bouclier.

## VI - Rendu et évaluation

Vous créerez dans le repo git un dossier dont le nom sera votre login. Vous y mettrez tous les fichiers nécessaires et vous ferez une pull request. N'oubliez pas de nommer votre commit "btsp " suivi de votre login.

Vos projets seront compilés et testés avec des grilles identiques pour éviter les injustices possibles. Le nombre de coups pour finir une grille sera votre score pour celle-ci. Si votre programme envoie un coup invalide, si la grille n'est pas résolue en 200 coups ou si votre programme timeout, la vm annoncera un score de 200. Les scores de toutes les grilles seront additionnés pour donner votre résultat final. Le participant ayant le score le plus bas sera désigné vainqueur.

Bonne chance à tous !

## VII - Récompenses

 - Le participant ayant le score le plus bas gagnera `42000` points de coalition si il est dans le nouveau cursus et `1000` si il est dans l'ancien.
 - Toute personne ayant proposé une solution valide dans le temps imparti gagnera `12600` ou `300` points selon son cursus.
 - Tous autre participant qui a tenté de résoudre le défi et a proposé une solution gagnera `8400` points ou `200` points selon son cursus.
